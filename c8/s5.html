

<!DOCTYPE html>


<html lang="zh-CN" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>8.5 电子邮件安全 &#8212; 计算机网络: 自顶向下</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystyles.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/tabs.js"></script>
    <script>let toggleHintShow = '原文';</script>
    <script>let toggleHintHide = '收起';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js"></script>
    <script src="../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'c8/s5';</script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="8.6 保护 TCP 连接: SSL" href="s6.html" />
    <link rel="prev" title="8.4 终端认证" href="s4.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="zh-CN"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">计算机网络: 自顶向下</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="搜索" aria-label="搜索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">搜索</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">内容</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../about_author.html">关于作者</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preface.html">前言</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c1/index.html">第 1 章 计算机网络与因特网</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c1/s1.html">1.1 什么是互联网？</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c1/s2.html">1.2 网络边缘</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c1/s3.html">1.3 网络核心</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c1/s4.html">1.4 分组交换网络中的时延、丢包与吞吐量</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c1/s5.html">1.5 协议层与其服务模型</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c1/s6.html">1.6 网络攻击</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c1/s7.html">1.7 计算机网络与互联网的发展历史</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c1/summary.html">1.8 小结</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c1/homework.html">家庭作业问题和疑问</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c1/wiresharklab.html">Wireshark 实验室</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c1/interview.html">访谈：Leonard Kleinrock</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c2/index.html">第 2 章 应用层</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c2/s1.html">2.1 网络应用程序原理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c2/s2.html">2.2 Web 与 HTTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c2/s3.html">2.3 互联网中的电子邮件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c2/s4.html">2.4 DNS——互联网的目录服务</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c2/s5.html">2.5 对等网络应用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c2/s6.html">2.6 视频流与内容分发</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c2/s7.html">2.7 套接字编程：创建网络应用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c2/summary.html">2.9 小结</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c2/homework.html">家庭作业问题和疑问</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c2/socketpro.html">Socket 编程作业</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c2/wiresharklab.html">Wireshark 实验室</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c2/interview.html">访谈: Marc Andreessen</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c3/index.html">第 3 章 传输层</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c3/s1.html">3.1 引言与传输层服务</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3/s2.html">3.2 复用与解复用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3/s3.html">3.3 无连接传输：UDP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3/s4.html">3.4 可靠数据传输的原理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3/s5.html">3.5 面向连接的传输：TCP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3/s6.html">3.6 拥塞控制原理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3/s7.html">3.7 TCP 拥塞控制</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3/summary.html">3.8 小结</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3/homework.html">家庭作业问题和疑问</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3/wiresharklab.html">Wireshark 实验室</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c3/interview.html">访谈: Van Jacobson</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c4/index.html">第 4 章 网络层：数据平面</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c4/s1.html">4.1 网络层概述</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c4/s2.html">4.2 路由器的内部结构</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c4/s3.html">4.3 Internet 协议（IP）：IPv4、地址、IPv6 等</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c4/s4.html">4.4 通用转发与 SDN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c4/summary.html">4.5 小结</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c4/homework.html">家庭作业问题和疑问</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c4/wiresharklab.html">Wireshark 实验室</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c4/interview.html">访谈: Vinton G. Cerf</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c5/index.html">第 5 章 网络层：控制平面</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c5/s1.html">5.1 引言</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c5/s2.html">5.2 路由算法</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c5/s3.html">5.3 互联网中的域内路由：OSPF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c5/s4.html">5.4 ISP 之间的路由：BGP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c5/s5.html">5.5 SDN 控制平面</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c5/s6.html">5.6 ICMP：因特网控制报文协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c5/s7.html">5.7 网络管理与 SNMP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c5/summary.html">5.8 小结</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c5/homework.html">家庭作业问题和疑问</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c5/wiresharklab.html">Wireshark 实验室</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c5/interview.html">访谈: Jennifer Rexford</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c6/index.html">第 6 章 链路层与局域网（LANs）</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c6/s1.html">6.1 链路层简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c6/s2.html">6.2 错误检测与纠正技术</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c6/s3.html">6.3 多路访问链路与协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c6/s4.html">6.4 交换式局域网</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c6/s5.html">6.5 链路虚拟化：作为链路层的网络</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c6/s6.html">6.6 数据中心网络</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c6/s7.html">6.7 回顾：网页请求生命周期中的一天</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c6/summary.html">6.8 小结</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c6/homework.html">家庭作业问题和疑问</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c6/wiresharklab.html">Wireshark 实验室</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c6/interview.html">访谈：Simon S. Lam</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c7/index.html">第 7 章 无线与移动网络</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c7/s1.html">7.1 简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c7/s2.html">7.2 无线链接和网络特性</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c7/s3.html">7.3 WiFi：802.11 无线局域网</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c7/s4.html">7.4 蜂窝互联网接入</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c7/s5.html">7.5 移动性管理：原理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c7/s6.html">7.6 移动 IP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c7/s7.html">7.7 蜂窝网络中的移动性管理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c7/s8.html">7.8 无线与移动性：对高层协议的影响</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c7/summary.html">7.9 小结</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c7/homework.html">家庭作业问题和疑问</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c7/wiresharklab.html">Wireshark 实验室</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c7/interview.html">访谈: Deborah Estrin</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">第 8 章 计算机网络中的安全</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="s1.html">8.1 什么是网络安全？</a></li>
<li class="toctree-l2"><a class="reference internal" href="s2.html">8.2 密码学原理</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3.html">8.3 消息完整性和数字签名</a></li>
<li class="toctree-l2"><a class="reference internal" href="s4.html">8.4 终端认证</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">8.5 电子邮件安全</a></li>
<li class="toctree-l2"><a class="reference internal" href="s6.html">8.6 保护 TCP 连接: SSL</a></li>
<li class="toctree-l2"><a class="reference internal" href="s7.html">8.7 网络层安全: IPsec 和虚拟专用网络</a></li>
<li class="toctree-l2"><a class="reference internal" href="s8.html">8.8 无线局域网的安全</a></li>
<li class="toctree-l2"><a class="reference internal" href="s9.html">8.9 运行安全：防火墙和入侵检测系统</a></li>
<li class="toctree-l2"><a class="reference internal" href="summary.html">8.10 小结</a></li>
<li class="toctree-l2"><a class="reference internal" href="homework.html">课后习题与问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="wiresharklab.html">Wireshark 实验室</a></li>
<li class="toctree-l2"><a class="reference internal" href="interview.html">访谈：Steven M. Bellovin</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../c9/index.html">第 9 章 多媒体网络</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../c9/s1.html">9.1 多媒体网络应用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c9/s2.html">9.2 流媒体存储视频</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c9/s3.html">9.3 基于 IP 的语音通信</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c9/s4.html">9.4 实时对话应用的协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c9/s5.html">9.5 多媒体的网络支持</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c9/summary.html">9.6 小结</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c9/homework.html">家庭作业问题和疑问</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c9/interview.html">访谈：Henning Schulzrinne</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">引用</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/hellowac/computer-net-zh-cn" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="源码库"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="下载此页面">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/c8/s5.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="下载源文件"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="列印成 PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="全屏模式"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="搜索" aria-label="搜索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>8.5 电子邮件安全</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> 目录 </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#c8-5-1">8.5.1 安全电子邮件</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pgp">8.5.2 PGP</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="c8-5">
<span id="id1"></span><h1>8.5 电子邮件安全<a class="headerlink" href="#c8-5" title="此标题的永久链接">#</a></h1>
<p>8.5 Securing E-Mail</p>
<p>在前面的章节中，我们探讨了网络安全的基本问题，包括对称密钥和公钥密码学、端点认证、密钥分发、消息完整性和数字签名。现在，我们将考察这些工具如何被用来为互联网提供安全保障。</p>
<p>有趣的是，可以在互联网协议栈的任何前四层中提供安全服务。当为特定的应用层协议提供安全性时，使用该协议的应用程序将享有一种或多种安全服务，如机密性、认证或完整性。当为传输层协议提供安全时，所有使用该协议的应用都享有传输协议的安全服务。当在主机到主机的网络层提供安全时，所有传输层段（因此所有应用层数据）都享有网络层的安全服务。当在链路层提供安全时，所有在该链路上传输的帧中的数据都获得链路的安全服务。</p>
<p>在 <a class="reference internal" href="#c8-5"><span class="std std-ref">第8.5节</span></a> 至 <a class="reference internal" href="s8.html#c8-8"><span class="std std-ref">第8.8节</span></a> 中，我们将分别考察安全工具在应用层、传输层、网络层和链路层的应用。与本书的一贯结构保持一致，我们从协议栈的顶层开始，讨论应用层的安全。我们的方式是以特定应用——电子邮件，作为应用层安全的案例研究。随后我们将逐层向下，考察提供传输层安全的 SSL 协议、提供网络层安全的 IPsec 以及 IEEE 802.11 无线局域网协议的安全性。</p>
<p>你可能会疑惑，为什么互联网中要在多个层提供安全功能。难道只在网络层提供安全功能不就足够了吗？对此有两个答案。首先，虽然网络层安全可以通过加密数据报中的所有数据（即所有传输层段）和认证所有源 IP 地址来提供“全方位覆盖”，但它不能提供用户级别的安全性。例如，一个商业网站不能依赖 IP 层安全来认证正在购买商品的客户。因此，除了低层的全覆盖外，高层也需要安全功能。其次，在协议栈的高层部署新互联网服务（包括安全服务）通常更容易。在等待网络层安全被广泛部署（这可能还需要许多年）期间，许多应用开发者“干脆动手”，在其喜爱的应用中引入安全功能。一个经典例子是 Pretty Good Privacy（PGP），提供了安全电子邮件（将在本节后面讨论）。PGP 仅需客户端和服务器的应用程序代码，是最早被广泛使用的互联网安全技术之一。</p>
<div class="toggle docutils container">
<p>In previous sections, we examined fundamental issues in network security, including symmetric key and public key cryptography, end-point authentication, key distribution, message integrity, and digital signatures. We are now going to examine how these tools are being used to provide security in the Internet.</p>
<p>Interestingly, it is possible to provide security services in any of the top four layers of the Internet protocol stack. When security is provided for a specific application-layer protocol, the application using the protocol will enjoy one or more security services, such as confidentiality, authentication, or integrity. When security is provided for a transport-layer protocol, all applications that use that protocol enjoy the security services of the transport protocol. When security is provided at the network layer on a host-to- host basis, all transport-layer segments (and hence all application-layer data) enjoy the security services of the network layer. When security is provided on a link basis, then the data in all frames traveling over the link receive the security services of the link.</p>
<p>In <a class="reference internal" href="#c8-5"><span class="std std-ref">Sections 8.5</span></a> through <a class="reference internal" href="s8.html#c8-8"><span class="std std-ref">8.8</span></a>, we examine how security tools are being used in the application, transport, network, and link layers. Being consistent with the general structure of this book, we begin at the top of the protocol stack and discuss security at the application layer. Our approach is to use a specific application, e-mail, as a case study for application-layer security. We then move down the protocol stack. We’ll examine the SSL protocol (which provides security at the transport layer), IPsec (which provides security at the network layer), and the security of the IEEE 802.11 wireless LAN protocol.</p>
<p>You might be wondering why security functionality is being provided at more than one layer in the Internet. Wouldn’t it suffice simply to provide the security functionality at the network layer and be done with it? There are two answers to this question. First, although security at the network layer can offer “blanket coverage” by encrypting all the data in the datagrams (that is, all the transport-layer segments) and by authenticating all the source IP addresses, it can’t provide user-level security. For example, a commerce site cannot rely on IP-layer security to authenticate a customer who is purchasing goods at the commerce site. Thus, there is a need for security functionality at higher layers as well as blanket coverage at lower layers. Second, it is generally easier to deploy new Internet services, including security services, at the higher layers of the protocol stack. While waiting for security to be broadly deployed at the network layer, which is probably still many years in the future, many application developers “just do it” and introduce security functionality into their favorite applications. A classic example is Pretty Good Privacy (PGP), which provides secure e-mail (discussed later in this section). Requiring only client and server application code, PGP was one of the first security technologies to be broadly used in the Internet.</p>
</div>
<section id="c8-5-1">
<span id="id2"></span><h2>8.5.1 安全电子邮件<a class="headerlink" href="#c8-5-1" title="此标题的永久链接">#</a></h2>
<p>8.5.1 Secure E-Mail</p>
<p>我们现在利用 <a class="reference internal" href="s2.html#c8-2"><span class="std std-ref">第8.2节</span></a> 至 <a class="reference internal" href="s3.html#c8-3"><span class="std std-ref">第8.3节</span></a> 中的密码学原理，创建一个安全电子邮件系统。我们以增量方式进行高层设计，每一步引入新的安全服务。设计安全电子邮件系统时，记住第8.1节介绍的激情故事——Alice 和 Bob 之间的爱情故事。想象 Alice 想给 Bob 发一封电子邮件，而 Trudy 想要入侵。</p>
<p>在设计 Alice 和 Bob 的安全电子邮件系统之前，我们应考虑哪些安全特性是他们最需要的。首先是机密性。正如 <a class="reference internal" href="s1.html#c8-1"><span class="std std-ref">第8.1节</span></a> 讨论的，Alice 和 Bob 都不希望 Trudy 阅读 Alice 的邮件。第二个 Alice 和 Bob 很可能希望看到的是发件人认证。特别是当 Bob 收到消息“我不再爱你了，我再也不想见你了，曾经属于你的 Alice”时，他自然想确定消息确实来自 Alice 而非 Trudy。第三个受欢迎的特性是消息完整性，也就是确保 Alice 发送的消息在传输途中未被篡改。最后，邮件系统还应提供收件人认证，也就是说，Alice 希望确认她发送的信确实是给 Bob，而不是冒充 Bob 的其他人（比如 Trudy）。</p>
<p>首先解决最重要的问题——机密性。提供机密性最直接的方法是 Alice 用对称密钥技术（如 DES 或 AES）加密消息，Bob 收到后解密。如 <a class="reference internal" href="s2.html#c8-2"><span class="std std-ref">第8.2节</span></a> 所述，如果对称密钥足够长，且只有 Alice 和 Bob 拥有密钥，那么除 Trudy 外的任何人都极难读懂消息。尽管此法直接，但正如 <a class="reference internal" href="s2.html#c8-2"><span class="std std-ref">第8.2节</span></a> 中讨论的，它存在根本难题——如何分发对称密钥，使得只有 Alice 和 Bob 拥有副本。因此，我们自然考虑另一种方法——公钥密码学（例如使用 RSA）。在公钥方案中，Bob 将他的公钥公开（如放在公钥服务器或个人网页上），Alice 用 Bob 的公钥加密消息，然后发送加密消息到 Bob 的邮箱。Bob 收到消息后，用私钥解密。假设 Alice 确认公钥确实是 Bob 的公钥，这种方法是提供机密性的绝佳手段。但问题是公钥加密效率相对较低，尤其是处理长消息时。</p>
<p>为解决效率问题，我们引入会话密钥（详见 <a class="reference internal" href="s2.html#c8-2-2"><span class="std std-ref">第8.2.2节</span></a>）。具体做法是，Alice (1) 选择一个随机的对称会话密钥 KS，(2) 用该对称密钥加密消息 m，(3) 用 Bob 的公钥 KB+ 加密该对称密钥，(4) 将加密后的消息和加密后的对称密钥串联成一个“包”，(5) 发送该包到 Bob 的邮箱。步骤如 <span class="xref std std-ref">图 8.19</span> 所示。（图中带圈的“+”代表串联，带圈的“−”代表拆分。）Bob 收到包后，(1) 用私钥 KB− 解密出对称密钥 KS，(2) 用 KS 解密消息 m。</p>
<figure class="align-center" id="figure-8-19">
<img alt="../_images/694-0.png" src="../_images/694-0.png" />
</figure>
<p><strong>图 8.19 Alice 使用对称会话密钥 KS 向 Bob 发送加密邮件</strong></p>
<p>在设计了提供机密性的安全电子邮件系统后，接下来设计一个同时提供发件人认证和消息完整性的系统。暂且假设 Alice 和 Bob 不再关心机密性（他们想让所有人都知道他们的感情！），只关心发件人认证和消息完整性。为实现该目标，我们使用数字签名和消息摘要，如 <a class="reference internal" href="s3.html#c8-3"><span class="std std-ref">第8.3节</span></a> 所述。具体做法是，Alice (1) 对消息 m 应用哈希函数 H（例如 MD5），得到消息摘要，(2) 用她的私钥 KA− 对摘要进行签名，生成数字签名，(3) 将原始（未加密）消息和签名串联成包，(4) 发送包到 Bob 的邮箱。Bob 收到包后，(1) 用 Alice 的公钥 KA+ 验证签名，(2) 将结果与自己对消息计算的哈希值 H 比较。步骤见 <a class="reference internal" href="#figure-8-20"><span class="std std-ref">图 8.20</span></a>。如 <a class="reference internal" href="s3.html#c8-3"><span class="std std-ref">第8.3节</span></a> 所述，如果两者一致，Bob 可以相当肯定消息来自 Alice 且未被篡改。</p>
<p>现在考虑设计一个同时提供机密性、发件人认证和消息完整性的电子邮件系统。可以将 <span class="xref std std-ref">图 8.19</span> 和 <span class="xref std std-ref">图 8.20</span> 中的步骤结合起来。Alice 首先创建一个初步包，内容如 <a class="reference internal" href="#figure-8-20"><span class="std std-ref">图 8.20</span></a>，包含原始消息和数字签名的消息摘要。然后她将此初步包视为消息本身，通过 <a class="reference internal" href="#figure-8-19"><span class="std std-ref">图 8.19</span></a> 中的发件人步骤加密，生成一个新的包发送给 Bob。Alice 的操作见 <a class="reference internal" href="#figure-8-21"><span class="std std-ref">图 8.21</span></a>。Bob 收到包后，先执行 <a class="reference internal" href="#figure-8-19"><span class="std std-ref">图 8.19</span></a> 中的接收步骤，再执行 <a class="reference internal" href="#figure-8-20"><span class="std std-ref">图 8.20</span></a> 中的接收步骤。显然，该设计实现了机密性、发件人认证和消息完整性的目标。注意，在此方案中，Alice 两次使用公钥密码学：一次用自己的私钥，一次用 Bob 的公钥。Bob 也两次使用公钥密码学：一次用自己的私钥，一次用 Alice 的公钥。</p>
<figure class="align-center" id="figure-8-20">
<img alt="../_images/695-0.png" src="../_images/695-0.png" />
</figure>
<p><strong>图 8.20 使用哈希函数和数字签名实现发件人认证和消息完整性</strong></p>
<p><a class="reference internal" href="#figure-8-21"><span class="std std-ref">图 8.21</span></a> 所示的安全电子邮件设计可能为大多数邮件用户提供了大多数情况下满意的安全性。但仍有一重要问题需解决。该设计要求 Alice 获得 Bob 的公钥，Bob 也获得 Alice 的公钥。公钥的分发并非易事。例如，Trudy 可能冒充 Bob，向 Alice 提供自己的公钥，声称是 Bob 的公钥，从而获得发给 Bob 的消息。正如 <a class="reference internal" href="s3.html#c8-3"><span class="std std-ref">第8.3节</span></a> 所学，安全分发公钥的一个常用方法是通过 CA 认证公钥。</p>
<figure class="align-center" id="figure-8-21">
<img alt="../_images/695-1.png" src="../_images/695-1.png" />
</figure>
<p><strong>图 8.21 Alice 使用对称密钥密码学、公钥密码学、哈希函数和数字签名，实现保密性、发件人认证和消息完整性</strong></p>
<div class="toggle docutils container">
<p>We now use the cryptographic principles of <a class="reference internal" href="s2.html#c8-2"><span class="std std-ref">Sections 8.2</span></a> through <a class="reference internal" href="s3.html#c8-3"><span class="std std-ref">8.3</span></a> to create a secure e-mail system. We create this high-level design in an incremental manner, at each step introducing new security services. When designing a secure e-mail system, let us keep in mind the racy example introduced in Section 8.1—the love affair between Alice and Bob. Imagine that Alice wants to send an e-mail message to Bob, and Trudy wants to intrude.</p>
<p>Before plowing ahead and designing a secure e-mail system for Alice and Bob, we should consider which security features would be most desirable for them. First and foremost is confidentiality. As discussed in <a class="reference internal" href="s1.html#c8-1"><span class="std std-ref">Section 8.1</span></a>, neither Alice nor Bob wants Trudy to read Alice’s e-mail message. The second feature that Alice and Bob would most likely want to see in the secure e-mail system is sender authentication. In particular, when Bob receives the message “I don’t love you anymore. I never want to see you again. Formerly yours, Alice, ” he would naturally want to be sure that the message came from Alice and not from Trudy. Another feature that the two lovers would appreciate is message integrity, that is, assurance that the message Alice sends is not modified while en route to Bob. Finally, the e-mail system should provide receiver authentication; that is, Alice wants to make sure that she is indeed sending the letter to Bob and not to someone else (for example, Trudy) who is impersonating Bob.</p>
<p>So let’s begin by addressing the foremost concern, confidentiality. The most straightforward way to provide confidentiality is for Alice to encrypt the message with symmetric key technology (such as DES or AES) and for Bob to decrypt the message on receipt. As discussed in <a class="reference internal" href="s2.html#c8-2"><span class="std std-ref">Section 8.2</span></a>, if the symmetric key is long enough, and if only Alice and Bob have the key, then it is extremely difficult for anyone else (including Trudy) to read the message. Although this approach is straightforward, it has the fundamental difficulty that we discussed in <a class="reference internal" href="s2.html#c8-2"><span class="std std-ref">Section 8.2</span></a>—distributing a symmetric key so that only Alice and Bob have copies of it. So we naturally consider an alternative approach—public key cryptography (using, for example, RSA). In the public key approach, Bob makes his public key publicly available (e.g., in a public key server or on his personal Web page), Alice encrypts her message with Bob’s public key, and she sends the encrypted message to Bob’s e-mail address. When Bob receives the message, he simply decrypts it with his private key. Assuming that Alice knows for sure that the public key is Bob’s public key, this approach is an excellent means to provide the desired confidentiality. One problem, however, is that public key encryption is relatively inefficient, particularly for long messages.</p>
<p>To overcome the efficiency problem, let’s make use of a session key (discussed in <a class="reference internal" href="s2.html#c8-2-2"><span class="std std-ref">Section 8.2.2</span></a>). In particular, Alice (1) selects a random symmetric session key, KS, (2) encrypts her message, m, with the symmetric key, (3) encrypts the symmetric key with Bob’s public key, KB+, (4) concatenates the encrypted message and the encrypted symmetric key to form a “package,” and (5) sends the package to Bob’s e-mail address. The steps are illustrated in <span class="xref std std-ref">Figure 8.19</span>. (In this and the subsequent figures, the circled “+” represents concatenation and the circled “−” represents deconcatenation.) When Bob receives the package, he (1) uses his private key, KB−, to obtain the symmetric key, KS, and (2) uses the symmetric key KS to decrypt the message m.</p>
<figure class="align-center">
<img alt="../_images/694-0.png" src="../_images/694-0.png" />
</figure>
<p><strong>Figure 8.19 Alice used a symmetric session key, KS, to send a secret e-mail to Bob</strong></p>
<p>Having designed a secure e-mail system that provides confidentiality, let’s now design another system that provides both sender authentication and message integrity. We’ll suppose, for the moment, that Alice and Bob are no longer concerned with confidentiality (they want to share their feelings with everyone!), and are concerned only about sender authentication and message integrity. To accomplish this task, we use digital signatures and message digests, as described in <a class="reference internal" href="s3.html#c8-3"><span class="std std-ref">Section 8.3</span></a>. Specifically, Alice (1) applies a hash function, H (for example, MD5), to her message, m, to obtain a message digest, (2) signs the result of the hash function with her private key, KA−, to create a digital signature, (3) concatenates the original (unencrypted) message with the signature to create a package, and (4) sends the package to Bob’s e-mail address. When Bob receives the package, he (1) applies Alice’s public key, KA+, to the signed message digest and (2) compares the result of this operation with his own hash, H, of the message. The steps are illustrated in <a class="reference internal" href="#figure-8-20"><span class="std std-ref">Figure 8.20</span></a>. As discussed in <a class="reference internal" href="s3.html#c8-3"><span class="std std-ref">Section 8.3</span></a>, if the two results are the same, Bob can be pretty confident that the message came from Alice and is unaltered.</p>
<p>Now let’s consider designing an e-mail system that provides confidentiality, sender authentication, and message integrity. This can be done by combining the procedures in <span class="xref std std-ref">Figures 8.19</span> and <span class="xref std std-ref">8.20</span>. Alice first creates a preliminary package, exactly as in <a class="reference internal" href="#figure-8-20"><span class="std std-ref">Figure 8.20</span></a>, that consists of her original message along with a digitally signed hash of the message. She then treats this preliminary package as a message in itself and sends this new message through the sender steps in <a class="reference internal" href="#figure-8-19"><span class="std std-ref">Figure 8.19</span></a>, creating a new package that is sent to Bob. The steps applied by Alice are shown in <a class="reference internal" href="#figure-8-21"><span class="std std-ref">Figure 8.21</span></a>. When Bob receives the package, he first applies his side of <a class="reference internal" href="#figure-8-19"><span class="std std-ref">Figure 8.19</span></a> and then his side of <a class="reference internal" href="#figure-8-20"><span class="std std-ref">Figure 8.20</span></a>. It should be clear that this design achieves the goal of providing confidentiality, sender authentication, and message integrity. Note that, in this scheme, Alice uses public key cryptography twice: once with her own private key and once with Bob’s public key. Similarly, Bob also uses public key cryptography twice—once with his private key and once with Alice’s public key.</p>
<figure class="align-center">
<img alt="../_images/695-0.png" src="../_images/695-0.png" />
</figure>
<p><strong>Figure 8.20 Using hash functions and digital signatures to provide ­sender authentication and message integrity</strong></p>
<p>The secure e-mail design outlined in <a class="reference internal" href="#figure-8-21"><span class="std std-ref">Figure 8.21</span></a> probably provides satisfactory security for most e-mail users for most occasions. But there is still one important issue that remains to be addressed. The design in <a class="reference internal" href="#figure-8-21"><span class="std std-ref">Figure 8.21</span></a> requires Alice to obtain Bob’s public key, and requires Bob to obtain Alice’s public key. The distribution of these public keys is a nontrivial problem. For example, Trudy might masquerade as Bob and give Alice her own public key while saying that it is Bob’s public key, enabling her to receive the message meant for Bob. As we learned in <a class="reference internal" href="s3.html#c8-3"><span class="std std-ref">Section 8.3</span></a>, a popular approach for securely distributing public keys is to certify the public keys using a CA.</p>
<figure class="align-center">
<img alt="../_images/695-1.png" src="../_images/695-1.png" />
</figure>
<p><strong>Figure 8.21 Alice uses symmetric key cyptography, public key cryptography, a hash function, and a digital signature to ­provide secrecy, sender authentication, and message integrity</strong></p>
</div>
</section>
<section id="pgp">
<span id="c8-5-2"></span><h2>8.5.2 PGP<a class="headerlink" href="#pgp" title="此标题的永久链接">#</a></h2>
<p>由 Phil Zimmermann 于1991年编写的 <strong>Pretty Good Privacy (PGP)</strong> 是电子邮件加密方案的一个典型例子 <a class="reference internal" href="../references.html#pgpi-2016"><span class="std std-ref">[PGPI 2016]</span></a>。PGP 有多个公开版本，例如你可以在国际 PGP 主页上找到适合你平台的 PGP 软件及大量有趣的阅读材料 <a class="reference internal" href="../references.html#pgpi-2016"><span class="std std-ref">[PGPI 2016]</span></a>。PGP 设计本质上与 <a class="reference internal" href="#figure-8-21"><span class="std std-ref">图 8.21</span></a> 的设计相同。不同版本的 PGP 软件使用 MD5 或 SHA 计算消息摘要；采用 CAST、三重 DES 或 IDEA 进行对称加密；用 RSA 实现公钥加密。</p>
<p>安装 PGP 后，软件为用户生成一对公钥。公钥可以发布在用户网站或公钥服务器上。私钥则由密码保护。用户每次访问私钥时必须输入密码。PGP 允许用户选择数字签名、消息加密，或同时进行数字签名和加密。<a class="reference internal" href="#figure-8-22"><span class="std std-ref">图 8.22</span></a> 显示了一个 PGP 签名消息。该消息位于 MIME 头之后。消息中的编码数据是 KA−(H(m))，即数字签名的消息摘要。正如上述讨论，为了让 Bob 验证消息完整性，他需要访问 Alice 的公钥。</p>
<p><a class="reference internal" href="#figure-8-23"><span class="std std-ref">图 8.23</span></a> 显示了一个秘密的 PGP 消息。该消息也位于 MIME 头之后。显然，明文消息不包含在秘密邮件消息中。当发送者（如 Alice）既想保证机密性又想保证完整性时，PGP 会将 <a class="reference internal" href="#figure-8-23"><span class="std std-ref">图 8.23</span></a> 中的消息包含在 <a class="reference internal" href="#figure-8-22"><span class="std std-ref">图 8.22</span></a> 的消息中。</p>
<p>PGP 还提供公钥认证机制，但机制与传统的 CA 大相径庭。PGP 公钥通过信任网络认证。当 Alice 认为某个密钥/用户名对确实对应时，她可以认证该对。此外，PGP 允许 Alice 表示她信任另一用户为更多密钥的真实性背书。一些 PGP 用户通过举办密钥签名聚会彼此签署密钥。用户们聚集交换公钥，并用私钥签署认证彼此的密钥。</p>
<figure class="align-center" id="figure-8-22">
<img alt="../_images/696-0.png" src="../_images/696-0.png" />
</figure>
<p><strong>图 8.22 一个 PGP 签名消息</strong></p>
<figure class="align-center" id="figure-8-23">
<img alt="../_images/697-0.png" src="../_images/697-0.png" />
</figure>
<p><strong>图 8.23 一个秘密的 PGP 消息</strong></p>
<div class="toggle docutils container">
<p>Written by Phil Zimmermann in 1991, <strong>Pretty Good Privacy (PGP)</strong> is a nice example of an e-mail encryption scheme <a class="reference internal" href="../references.html#pgpi-2016"><span class="std std-ref">[PGPI 2016]</span></a>. Versions of PGP are available in the public domain; for example, you can find the PGP software for your favorite platform as well as lots of interesting reading at the International PGP Home Page <a class="reference internal" href="../references.html#pgpi-2016"><span class="std std-ref">[PGPI 2016]</span></a>. The PGP design is, in essence, the same as the design shown in <a class="reference internal" href="#figure-8-21"><span class="std std-ref">Figure 8.21</span></a>. Depending on the version, the PGP software uses MD5 or SHA for calculating the message digest; CAST, triple-DES, or IDEA for symmetric key encryption; and RSA for the public key encryption.</p>
<p>When PGP is installed, the software creates a public key pair for the user. The public key can be posted on the user’s Web site or placed in a public key server. The private key is protected by the use of a password. The password has to be entered every time the user accesses the private key. PGP gives the user the option of digitally signing the message, encrypting the message, or both digitally signing and
encrypting. <a class="reference internal" href="#figure-8-22"><span class="std std-ref">Figure 8.22</span></a> shows a PGP signed message. This message appears after the MIME header. The encoded data in the message is KA−(H(m)), that is, the digitally signed message digest. As we discussed above, in order for Bob to verify the integrity of the message, he needs to have access to Alice’s public key.</p>
<p><a class="reference internal" href="#figure-8-23"><span class="std std-ref">Figure 8.23</span></a> shows a secret PGP message. This message also appears after the MIME header. Of course, the plaintext message is not included within the secret e-mail message. When a sender (such as Alice) wants both confidentiality and integrity, PGP contains a message like that of <a class="reference internal" href="#figure-8-23"><span class="std std-ref">Figure 8.23</span></a> within the message of <a class="reference internal" href="#figure-8-22"><span class="std std-ref">Figure 8.22</span></a>.</p>
<p>PGP also provides a mechanism for public key certification, but the mechanism is quite different from the more conventional CA. PGP public keys are certified by a web of trust. Alice herself can certify any key/username pair when she believes the pair really belong together. In addition, PGP permits Alice to say that she trusts another user to vouch for the authenticity of more keys. Some PGP users sign each other’s keys by holding key-signing parties. Users physically gather, exchange ­public keys, and certify each other’s keys by signing them with their private keys.</p>
<figure class="align-center">
<img alt="../_images/696-0.png" src="../_images/696-0.png" />
</figure>
<p><strong>Figure 8.22 A PGP signed message</strong></p>
<figure class="align-center">
<img alt="../_images/697-0.png" src="../_images/697-0.png" />
</figure>
<p><strong>Figure 8.23 A secret PGP message</strong></p>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="s4.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">上一页</p>
        <p class="prev-next-title">8.4 终端认证</p>
      </div>
    </a>
    <a class="right-next"
       href="s6.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">下一页</p>
        <p class="prev-next-title">8.6 保护 TCP 连接: SSL</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> 目录
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#c8-5-1">8.5.1 安全电子邮件</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pgp">8.5.2 PGP</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
作者： Jim Kurose/Keith Ross
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Jim Kurose/Keith Ross.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>